<?php

/**
 * Created by PhpStorm.
 * User: Windy
 * Date: 2019/2/2
 * Time: 9:31
 */

namespace Common\Console\Commands\Columbia;

use Common\Models\User\User;
use Common\Models\User\UserAuth;
use Common\Models\User\UserContact;
use Common\Models\User\UserInfo;
use Common\Models\User\UserWork;
use Common\Models\BankCard\BankCardPeso;
use Common\Models\Columbia\ColUserCoupon;
use Common\Utils\MerchantHelper;
use DB;
use Illuminate\Console\Command;

class DataImport extends Command {

    const FROM_MERCHANT_ID = 3;
    const TO_MERCHANT_ID = 5;
    const TABLES = [
        "user_auth" => ["where" => "", "model" => UserAuth::class],
        "user_contact" => ["where" => "", "model" => UserContact::class],
        "user_info" => ["where" => "", "model" => UserInfo::class],
        "user_work" => ["where" => "", "model" => UserWork::class],
        "bank_card_peso" => ["where" => " AND status=1 ", "model" => BankCardPeso::class],
    ];
    const COUPON_MAP = [
        "type1" => "7",
        "type2" => "8",
        "type3" => "9",
        "type4" => "10",
        "type5" => "11",
    ];
    const DATA_LIST = [
        ['1015471', 'type1'],
        ['1028524', 'type1'],
        ['1005695', 'type1'],
        ['936859', 'type1'],
        ['1018926', 'type1'],
        ['928134', 'type1'],
        ['983953', 'type1'],
        ['852663', 'type1'],
        ['899412', 'type1'],
        ['1040322', 'type1'],
        ['959431', 'type1'],
        ['937165', 'type1'],
        ['795184', 'type1'],
        ['472673', 'type1'],
        ['426105', 'type1'],
        ['1048809', 'type1'],
        ['465884', 'type1'],
        ['1008906', 'type1'],
        ['882078', 'type1'],
        ['808375', 'type1'],
        ['911452', 'type1'],
        ['969001', 'type1'],
        ['946911', 'type1'],
        ['929876', 'type1'],
        ['990775', 'type1'],
        ['991173', 'type1'],
        ['912704', 'type1'],
        ['654950', 'type1'],
        ['815513', 'type1'],
        ['878110', 'type1'],
        ['562324', 'type1'],
        ['983146', 'type1'],
        ['1004120', 'type1'],
        ['993212', 'type1'],
        ['626393', 'type1'],
        ['964029', 'type1'],
        ['1005260', 'type1'],
        ['967116', 'type1'],
        ['953301', 'type1'],
        ['725921', 'type1'],
        ['892316', 'type1'],
        ['895587', 'type1'],
        ['671943', 'type1'],
        ['902561', 'type1'],
        ['937397', 'type1'],
        ['733838', 'type1'],
        ['162473', 'type1'],
        ['945012', 'type1'],
        ['904791', 'type1'],
        ['172500', 'type1'],
        ['922627', 'type1'],
        ['983774', 'type1'],
        ['867072', 'type1'],
        ['994442', 'type1'],
        ['529744', 'type1'],
        ['858596', 'type1'],
        ['937082', 'type1'],
        ['933019', 'type1'],
        ['954491', 'type1'],
        ['980938', 'type1'],
        ['1003914', 'type1'],
        ['945573', 'type1'],
        ['984855', 'type1'],
        ['847185', 'type1'],
        ['1008234', 'type1'],
        ['999744', 'type1'],
        ['907237', 'type1'],
        ['358844', 'type1'],
        ['864373', 'type1'],
        ['1010764', 'type1'],
        ['778742', 'type1'],
        ['818204', 'type1'],
        ['769865', 'type1'],
        ['946788', 'type1'],
        ['991967', 'type1'],
        ['933023', 'type1'],
        ['972063', 'type1'],
        ['995631', 'type1'],
        ['822335', 'type1'],
        ['811515', 'type1'],
        ['824402', 'type1'],
        ['848609', 'type1'],
        ['864344', 'type1'],
        ['121360', 'type1'],
        ['955110', 'type1'],
        ['957919', 'type1'],
        ['894245', 'type1'],
        ['688569', 'type1'],
        ['874752', 'type1'],
        ['748338', 'type1'],
        ['939846', 'type1'],
        ['638620', 'type1'],
        ['955151', 'type1'],
        ['892032', 'type1'],
        ['890425', 'type1'],
        ['968010', 'type1'],
        ['961709', 'type1'],
        ['860815', 'type1'],
        ['860094', 'type1'],
        ['875834', 'type1'],
        ['823154', 'type1'],
        ['955511', 'type1'],
        ['802132', 'type1'],
        ['912670', 'type1'],
        ['951988', 'type1'],
        ['931635', 'type1'],
        ['891479', 'type1'],
        ['902737', 'type1'],
        ['894662', 'type1'],
        ['930316', 'type1'],
        ['727492', 'type1'],
        ['788156', 'type1'],
        ['783066', 'type1'],
        ['979231', 'type1'],
        ['931956', 'type1'],
        ['898957', 'type1'],
        ['894883', 'type1'],
        ['889080', 'type1'],
        ['928495', 'type1'],
        ['931601', 'type1'],
        ['917450', 'type1'],
        ['914228', 'type1'],
        ['712992', 'type1'],
        ['922285', 'type1'],
        ['911270', 'type1'],
        ['205124', 'type1'],
        ['942566', 'type1'],
        ['205365', 'type1'],
        ['864211', 'type1'],
        ['923910', 'type1'],
        ['876883', 'type1'],
        ['963490', 'type1'],
        ['793625', 'type1'],
        ['872715', 'type1'],
        ['794693', 'type1'],
        ['898491', 'type1'],
        ['145271', 'type1'],
        ['887624', 'type1'],
        ['916173', 'type1'],
        ['958249', 'type1'],
        ['784539', 'type1'],
        ['861009', 'type1'],
        ['921520', 'type1'],
        ['891627', 'type1'],
        ['783731', 'type1'],
        ['868200', 'type1'],
        ['899909', 'type1'],
        ['186165', 'type1'],
        ['914388', 'type1'],
        ['914439', 'type1'],
        ['870237', 'type1'],
        ['778659', 'type1'],
        ['963583', 'type1'],
        ['937884', 'type1'],
        ['915945', 'type1'],
        ['906150', 'type1'],
        ['965462', 'type1'],
        ['904162', 'type1'],
        ['913072', 'type1'],
        ['867631', 'type1'],
        ['576301', 'type1'],
        ['178116', 'type1'],
        ['182211', 'type1'],
        ['641890', 'type1'],
        ['827795', 'type1'],
        ['849653', 'type1'],
        ['931076', 'type1'],
        ['897943', 'type1'],
        ['825173', 'type1'],
        ['197225', 'type1'],
        ['215121', 'type1'],
        ['138940', 'type1'],
        ['470381', 'type1'],
        ['773171', 'type1'],
        ['161085', 'type1'],
        ['905270', 'type1'],
        ['1013509', 'type1'],
        ['120289', 'type1'],
        ['255215', 'type1'],
        ['139420', 'type1'],
        ['956790', 'type1'],
        ['131168', 'type1'],
        ['122739', 'type1'],
        ['198944', 'type1'],
        ['1075413', 'type1'],
        ['982994', 'type1'],
        ['154585', 'type1'],
        ['951034', 'type1'],
        ['157230', 'type1'],
        ['835803', 'type2'],
        ['910793', 'type2'],
        ['543205', 'type2'],
        ['970263', 'type2'],
        ['242265', 'type2'],
        ['1038639', 'type2'],
        ['1049900', 'type2'],
        ['1047497', 'type2'],
        ['1018967', 'type2'],
        ['871026', 'type2'],
        ['1048289', 'type2'],
        ['1038324', 'type2'],
        ['730406', 'type2'],
        ['921407', 'type2'],
        ['1034028', 'type2'],
        ['1048468', 'type2'],
        ['980699', 'type2'],
        ['693377', 'type2'],
        ['1018276', 'type2'],
        ['1021517', 'type2'],
        ['1045681', 'type2'],
        ['1016694', 'type2'],
        ['1040271', 'type2'],
        ['1020107', 'type2'],
        ['1014382', 'type2'],
        ['954808', 'type2'],
        ['1040488', 'type2'],
        ['1039609', 'type2'],
        ['855718', 'type2'],
        ['976050', 'type2'],
        ['507698', 'type2'],
        ['1008407', 'type2'],
        ['118213', 'type2'],
        ['969146', 'type2'],
        ['984542', 'type2'],
        ['886696', 'type2'],
        ['893212', 'type2'],
        ['920698', 'type2'],
        ['988231', 'type2'],
        ['125559', 'type2'],
        ['966596', 'type2'],
        ['940257', 'type2'],
        ['946270', 'type2'],
        ['898028', 'type2'],
        ['784111', 'type2'],
        ['937034', 'type2'],
        ['947407', 'type2'],
        ['995158', 'type2'],
        ['948045', 'type2'],
        ['954811', 'type2'],
        ['978320', 'type2'],
        ['146360', 'type2'],
        ['812994', 'type2'],
        ['961631', 'type2'],
        ['150045', 'type2'],
        ['541667', 'type2'],
        ['971136', 'type2'],
        ['915308', 'type2'],
        ['980394', 'type2'],
        ['159832', 'type2'],
        ['809193', 'type2'],
        ['910777', 'type2'],
        ['969490', 'type2'],
        ['931862', 'type2'],
        ['861396', 'type2'],
        ['875016', 'type2'],
        ['990073', 'type2'],
        ['980862', 'type2'],
        ['818935', 'type2'],
        ['1014987', 'type2'],
        ['945125', 'type2'],
        ['412863', 'type2'],
        ['981828', 'type2'],
        ['988602', 'type2'],
        ['699521', 'type2'],
        ['859217', 'type2'],
        ['959258', 'type2'],
        ['974220', 'type2'],
        ['938601', 'type2'],
        ['1004860', 'type2'],
        ['902499', 'type2'],
        ['944675', 'type2'],
        ['855033', 'type2'],
        ['1012380', 'type2'],
        ['953719', 'type2'],
        ['993451', 'type2'],
        ['946754', 'type2'],
        ['934113', 'type2'],
        ['1006194', 'type2'],
        ['996678', 'type2'],
        ['974647', 'type2'],
        ['585316', 'type2'],
        ['917651', 'type2'],
        ['726898', 'type2'],
        ['123463', 'type2'],
        ['1004671', 'type2'],
        ['918245', 'type2'],
        ['946977', 'type2'],
        ['990404', 'type2'],
        ['978457', 'type2'],
        ['963258', 'type2'],
        ['676042', 'type2'],
        ['153054', 'type2'],
        ['862856', 'type2'],
        ['796470', 'type2'],
        ['980467', 'type2'],
        ['954271', 'type2'],
        ['913111', 'type2'],
        ['926172', 'type2'],
        ['902626', 'type2'],
        ['929016', 'type2'],
        ['964821', 'type2'],
        ['979144', 'type2'],
        ['801873', 'type2'],
        ['954174', 'type2'],
        ['855852', 'type2'],
        ['959673', 'type2'],
        ['921439', 'type2'],
        ['1003090', 'type2'],
        ['773525', 'type2'],
        ['939305', 'type2'],
        ['948042', 'type2'],
        ['842599', 'type2'],
        ['194331', 'type2'],
        ['926416', 'type2'],
        ['932284', 'type2'],
        ['932311', 'type2'],
        ['991767', 'type2'],
        ['910336', 'type2'],
        ['853457', 'type2'],
        ['878109', 'type2'],
        ['638222', 'type2'],
        ['836406', 'type2'],
        ['134013', 'type2'],
        ['444085', 'type2'],
        ['871976', 'type2'],
        ['862285', 'type2'],
        ['977413', 'type2'],
        ['601092', 'type2'],
        ['961568', 'type2'],
        ['857106', 'type2'],
        ['170516', 'type2'],
        ['698897', 'type2'],
        ['965162', 'type2'],
        ['895347', 'type2'],
        ['938944', 'type2'],
        ['911255', 'type2'],
        ['497100', 'type2'],
        ['192294', 'type2'],
        ['195391', 'type2'],
        ['197022', 'type2'],
        ['904627', 'type2'],
        ['846455', 'type2'],
        ['915075', 'type2'],
        ['894655', 'type2'],
        ['911606', 'type2'],
        ['892429', 'type2'],
        ['898337', 'type2'],
        ['174705', 'type2'],
        ['609799', 'type2'],
        ['206648', 'type2'],
        ['903162', 'type2'],
        ['211005', 'type2'],
        ['461814', 'type2'],
        ['897294', 'type2'],
        ['185977', 'type2'],
        ['874894', 'type2'],
        ['889861', 'type2'],
        ['212922', 'type2'],
        ['140203', 'type2'],
        ['922858', 'type2'],
        ['526034', 'type2'],
        ['164963', 'type2'],
        ['1016543', 'type2'],
        ['164795', 'type2'],
        ['1014809', 'type3'],
        ['894261', 'type3'],
        ['853793', 'type3'],
        ['1019236', 'type3'],
        ['1022740', 'type3'],
        ['1043433', 'type3'],
        ['967641', 'type3'],
        ['1043415', 'type3'],
        ['134808', 'type3'],
        ['344815', 'type3'],
        ['943849', 'type3'],
        ['1041876', 'type3'],
        ['1024967', 'type3'],
        ['901181', 'type3'],
        ['1052371', 'type3'],
        ['1025461', 'type3'],
        ['1040626', 'type3'],
        ['945428', 'type3'],
        ['1023136', 'type3'],
        ['867122', 'type3'],
        ['922296', 'type3'],
        ['1020066', 'type3'],
        ['717095', 'type3'],
        ['1000912', 'type3'],
        ['239926', 'type3'],
        ['1005609', 'type3'],
        ['762708', 'type3'],
        ['893288', 'type3'],
        ['1037540', 'type3'],
        ['946016', 'type3'],
        ['918905', 'type3'],
        ['635813', 'type3'],
        ['879206', 'type3'],
        ['921978', 'type3'],
        ['795351', 'type3'],
        ['916584', 'type3'],
        ['1020281', 'type3'],
        ['1036506', 'type3'],
        ['1018062', 'type3'],
        ['295642', 'type3'],
        ['253028', 'type3'],
        ['740719', 'type3'],
        ['772151', 'type3'],
        ['963739', 'type3'],
        ['980864', 'type3'],
        ['990618', 'type3'],
        ['674084', 'type3'],
        ['823291', 'type3'],
        ['844722', 'type3'],
        ['786428', 'type3'],
        ['872193', 'type3'],
        ['1003930', 'type3'],
        ['973734', 'type3'],
        ['954779', 'type3'],
        ['1019441', 'type3'],
        ['974842', 'type3'],
        ['1008026', 'type3'],
        ['975248', 'type3'],
        ['902335', 'type3'],
        ['760600', 'type3'],
        ['999886', 'type3'],
        ['1015802', 'type3'],
        ['176292', 'type3'],
        ['994742', 'type3'],
        ['884756', 'type3'],
        ['900743', 'type3'],
        ['181362', 'type3'],
        ['1000324', 'type3'],
        ['722841', 'type3'],
        ['915069', 'type3'],
        ['919872', 'type3'],
        ['832257', 'type3'],
        ['688714', 'type3'],
        ['891822', 'type3'],
        ['759250', 'type3'],
        ['983103', 'type3'],
        ['1035592', 'type3'],
        ['893897', 'type3'],
        ['964986', 'type3'],
        ['945323', 'type3'],
        ['999520', 'type3'],
        ['985012', 'type3'],
        ['1002551', 'type3'],
        ['969822', 'type3'],
        ['748976', 'type3'],
        ['954576', 'type3'],
        ['994431', 'type3'],
        ['974422', 'type3'],
        ['989273', 'type3'],
        ['960909', 'type3'],
        ['1009434', 'type3'],
        ['947220', 'type3'],
        ['213302', 'type3'],
        ['883746', 'type3'],
        ['932072', 'type3'],
        ['979788', 'type3'],
        ['947047', 'type3'],
        ['749530', 'type3'],
        ['353776', 'type3'],
        ['911982', 'type3'],
        ['283830', 'type3'],
        ['974178', 'type3'],
        ['931908', 'type3'],
        ['922470', 'type3'],
        ['954173', 'type3'],
        ['742631', 'type3'],
        ['890268', 'type3'],
        ['934358', 'type3'],
        ['586848', 'type3'],
        ['997008', 'type3'],
        ['155454', 'type3'],
        ['900644', 'type3'],
        ['884490', 'type3'],
        ['824360', 'type3'],
        ['914984', 'type3'],
        ['859227', 'type3'],
        ['855595', 'type3'],
        ['963364', 'type3'],
        ['962106', 'type3'],
        ['561565', 'type3'],
        ['816325', 'type3'],
        ['782557', 'type3'],
        ['981209', 'type3'],
        ['847370', 'type3'],
        ['858040', 'type3'],
        ['969413', 'type3'],
        ['954703', 'type3'],
        ['972355', 'type3'],
        ['961658', 'type3'],
        ['913552', 'type3'],
        ['192702', 'type3'],
        ['936982', 'type3'],
        ['854277', 'type3'],
        ['909720', 'type3'],
        ['869512', 'type3'],
        ['981144', 'type3'],
        ['968963', 'type3'],
        ['848466', 'type3'],
        ['878344', 'type3'],
        ['461030', 'type3'],
        ['899501', 'type3'],
        ['956331', 'type3'],
        ['133860', 'type3'],
        ['489723', 'type3'],
        ['911692', 'type3'],
        ['473275', 'type3'],
        ['157074', 'type3'],
        ['914535', 'type3'],
        ['865593', 'type3'],
        ['884539', 'type3'],
        ['633646', 'type3'],
        ['186587', 'type3'],
        ['863795', 'type3'],
        ['897932', 'type3'],
        ['810103', 'type3'],
        ['716893', 'type3'],
        ['910807', 'type3'],
        ['893377', 'type3'],
        ['663420', 'type3'],
        ['892218', 'type3'],
        ['945529', 'type3'],
        ['887851', 'type3'],
        ['423142', 'type3'],
        ['176162', 'type3'],
        ['605792', 'type3'],
        ['876078', 'type3'],
        ['582435', 'type3'],
        ['434321', 'type3'],
        ['924214', 'type3'],
        ['897128', 'type3'],
        ['487469', 'type3'],
        ['173599', 'type3'],
        ['204663', 'type3'],
        ['490913', 'type3'],
        ['131424', 'type3'],
        ['915754', 'type3'],
        ['201291', 'type3'],
        ['164649', 'type3'],
        ['128962', 'type3'],
        ['166943', 'type3'],
        ['189792', 'type3'],
        ['159806', 'type3'],
        ['131922', 'type3'],
        ['998149', 'type3'],
        ['158857', 'type3'],
        ['988028', 'type4'],
        ['971595', 'type4'],
        ['141376', 'type4'],
        ['1025987', 'type4'],
        ['983891', 'type4'],
        ['1020873', 'type4'],
        ['866482', 'type4'],
        ['977458', 'type4'],
        ['777131', 'type4'],
        ['972113', 'type4'],
        ['1014023', 'type4'],
        ['1005031', 'type4'],
        ['1039171', 'type4'],
        ['957784', 'type4'],
        ['978691', 'type4'],
        ['941571', 'type4'],
        ['1038920', 'type4'],
        ['833171', 'type4'],
        ['1037771', 'type4'],
        ['1043628', 'type4'],
        ['987738', 'type4'],
        ['639446', 'type4'],
        ['946925', 'type4'],
        ['845865', 'type4'],
        ['469724', 'type4'],
        ['909913', 'type4'],
        ['972282', 'type4'],
        ['792344', 'type4'],
        ['819171', 'type4'],
        ['1004064', 'type4'],
        ['996757', 'type4'],
        ['587335', 'type4'],
        ['937989', 'type4'],
        ['979613', 'type4'],
        ['809962', 'type4'],
        ['994278', 'type4'],
        ['846526', 'type4'],
        ['999844', 'type4'],
        ['967612', 'type4'],
        ['978594', 'type4'],
        ['997056', 'type4'],
        ['978493', 'type4'],
        ['991641', 'type4'],
        ['946099', 'type4'],
        ['922299', 'type4'],
        ['990592', 'type4'],
        ['991112', 'type4'],
        ['1005974', 'type4'],
        ['994398', 'type4'],
        ['988320', 'type4'],
        ['978387', 'type4'],
        ['981310', 'type4'],
        ['955666', 'type4'],
        ['955530', 'type4'],
        ['995804', 'type4'],
        ['1016739', 'type4'],
        ['993828', 'type4'],
        ['797394', 'type4'],
        ['749957', 'type4'],
        ['992462', 'type4'],
        ['798781', 'type4'],
        ['988564', 'type4'],
        ['775503', 'type4'],
        ['951709', 'type4'],
        ['951370', 'type4'],
        ['965024', 'type4'],
        ['826332', 'type4'],
        ['906699', 'type4'],
        ['999730', 'type4'],
        ['1002310', 'type4'],
        ['966067', 'type4'],
        ['935402', 'type4'],
        ['961350', 'type4'],
        ['956760', 'type4'],
        ['703961', 'type4'],
        ['983722', 'type4'],
        ['823334', 'type4'],
        ['986181', 'type4'],
        ['915065', 'type4'],
        ['955959', 'type4'],
        ['553584', 'type4'],
        ['867778', 'type4'],
        ['926384', 'type4'],
        ['933385', 'type4'],
        ['393735', 'type4'],
        ['926564', 'type4'],
        ['961487', 'type4'],
        ['843373', 'type4'],
        ['870677', 'type4'],
        ['981080', 'type4'],
        ['972020', 'type4'],
        ['954898', 'type4'],
        ['976585', 'type4'],
        ['139299', 'type4'],
        ['978879', 'type4'],
        ['140605', 'type4'],
        ['857360', 'type4'],
        ['911504', 'type4'],
        ['868379', 'type4'],
        ['384294', 'type4'],
        ['935853', 'type4'],
        ['947359', 'type4'],
        ['860587', 'type4'],
        ['894410', 'type4'],
        ['986532', 'type4'],
        ['902150', 'type4'],
        ['817858', 'type4'],
        ['906238', 'type4'],
        ['162278', 'type4'],
        ['953240', 'type4'],
        ['957066', 'type4'],
        ['923242', 'type4'],
        ['929007', 'type4'],
        ['934629', 'type4'],
        ['968674', 'type4'],
        ['816093', 'type4'],
        ['881749', 'type4'],
        ['869818', 'type4'],
        ['951356', 'type4'],
        ['671205', 'type4'],
        ['915652', 'type4'],
        ['663791', 'type4'],
        ['942648', 'type4'],
        ['891266', 'type4'],
        ['948226', 'type4'],
        ['966165', 'type4'],
        ['896312', 'type4'],
        ['914969', 'type4'],
        ['964428', 'type4'],
        ['725627', 'type4'],
        ['879930', 'type4'],
        ['479110', 'type4'],
        ['957910', 'type4'],
        ['886012', 'type4'],
        ['890592', 'type4'],
        ['956014', 'type4'],
        ['779258', 'type4'],
        ['972015', 'type4'],
        ['119999', 'type4'],
        ['403261', 'type4'],
        ['840191', 'type4'],
        ['895350', 'type4'],
        ['858997', 'type4'],
        ['434755', 'type4'],
        ['428312', 'type4'],
        ['897279', 'type4'],
        ['924868', 'type4'],
        ['957918', 'type4'],
        ['923136', 'type4'],
        ['901088', 'type4'],
        ['947226', 'type4'],
        ['938413', 'type4'],
        ['915731', 'type4'],
        ['118681', 'type4'],
        ['129681', 'type4'],
        ['914950', 'type4'],
        ['850538', 'type4'],
        ['899417', 'type4'],
        ['905131', 'type4'],
        ['860338', 'type4'],
        ['560830', 'type4'],
        ['760720', 'type4'],
        ['640531', 'type4'],
        ['169888', 'type4'],
        ['470603', 'type4'],
        ['484756', 'type4'],
        ['182626', 'type4'],
        ['925310', 'type4'],
        ['894073', 'type4'],
        ['866537', 'type4'],
        ['863516', 'type4'],
        ['919278', 'type4'],
        ['892203', 'type4'],
        ['845920', 'type4'],
        ['879212', 'type4'],
        ['155341', 'type4'],
        ['891811', 'type4'],
        ['209420', 'type4'],
        ['132464', 'type4'],
        ['161223', 'type4'],
        ['192300', 'type4'],
        ['389021', 'type4'],
        ['137935', 'type4'],
        ['147639', 'type4'],
        ['156878', 'type4'],
        ['168240', 'type4'],
        ['138853', 'type4'],
        ['197330', 'type4'],
        ['162389', 'type4'],
        ['157879', 'type4'],
        ['858762', 'type5'],
        ['982477', 'type5'],
        ['991201', 'type5'],
        ['459306', 'type5'],
        ['484728', 'type5'],
        ['919337', 'type5'],
        ['1022271', 'type5'],
        ['612509', 'type5'],
        ['773660', 'type5'],
        ['1037368', 'type5'],
        ['906303', 'type5'],
        ['1023436', 'type5'],
        ['832142', 'type5'],
        ['1023680', 'type5'],
        ['982595', 'type5'],
        ['1038963', 'type5'],
        ['1025248', 'type5'],
        ['898346', 'type5'],
        ['946467', 'type5'],
        ['880157', 'type5'],
        ['834109', 'type5'],
        ['1015556', 'type5'],
        ['878771', 'type5'],
        ['401997', 'type5'],
        ['1039582', 'type5'],
        ['996271', 'type5'],
        ['959104', 'type5'],
        ['125180', 'type5'],
        ['945483', 'type5'],
        ['976459', 'type5'],
        ['994989', 'type5'],
        ['776266', 'type5'],
        ['910187', 'type5'],
        ['745392', 'type5'],
        ['854412', 'type5'],
        ['942673', 'type5'],
        ['916091', 'type5'],
        ['986570', 'type5'],
        ['1006185', 'type5'],
        ['947010', 'type5'],
        ['886241', 'type5'],
        ['978713', 'type5'],
        ['947558', 'type5'],
        ['947042', 'type5'],
        ['999623', 'type5'],
        ['959451', 'type5'],
        ['998843', 'type5'],
        ['667436', 'type5'],
        ['771217', 'type5'],
        ['927932', 'type5'],
        ['960759', 'type5'],
        ['1064069', 'type5'],
        ['994301', 'type5'],
        ['445512', 'type5'],
        ['783983', 'type5'],
        ['1013483', 'type5'],
        ['827696', 'type5'],
        ['990092', 'type5'],
        ['886528', 'type5'],
        ['1005253', 'type5'],
        ['865027', 'type5'],
        ['933305', 'type5'],
        ['384571', 'type5'],
        ['988809', 'type5'],
        ['947281', 'type5'],
        ['720259', 'type5'],
        ['476478', 'type5'],
        ['977290', 'type5'],
        ['968366', 'type5'],
        ['995257', 'type5'],
        ['995277', 'type5'],
        ['972256', 'type5'],
        ['845494', 'type5'],
        ['954099', 'type5'],
        ['1009984', 'type5'],
        ['983745', 'type5'],
        ['210085', 'type5'],
        ['915139', 'type5'],
        ['797174', 'type5'],
        ['967696', 'type5'],
        ['918174', 'type5'],
        ['559779', 'type5'],
        ['897828', 'type5'],
        ['995391', 'type5'],
        ['126287', 'type5'],
        ['886163', 'type5'],
        ['679523', 'type5'],
        ['885991', 'type5'],
        ['858774', 'type5'],
        ['950952', 'type5'],
        ['905161', 'type5'],
        ['693137', 'type5'],
        ['855676', 'type5'],
        ['892674', 'type5'],
        ['142762', 'type5'],
        ['905016', 'type5'],
        ['934452', 'type5'],
        ['148500', 'type5'],
        ['698501', 'type5'],
        ['869466', 'type5'],
        ['154700', 'type5'],
        ['651600', 'type5'],
        ['958812', 'type5'],
        ['792213', 'type5'],
        ['974405', 'type5'],
        ['978146', 'type5'],
        ['895415', 'type5'],
        ['745574', 'type5'],
        ['981752', 'type5'],
        ['863576', 'type5'],
        ['945399', 'type5'],
        ['909883', 'type5'],
        ['897048', 'type5'],
        ['629296', 'type5'],
        ['898276', 'type5'],
        ['473780', 'type5'],
        ['953418', 'type5'],
        ['927150', 'type5'],
        ['990951', 'type5'],
        ['250289', 'type5'],
        ['917452', 'type5'],
        ['984055', 'type5'],
        ['807197', 'type5'],
        ['912397', 'type5'],
        ['887877', 'type5'],
        ['982065', 'type5'],
        ['843255', 'type5'],
        ['983554', 'type5'],
        ['954463', 'type5'],
        ['864909', 'type5'],
        ['959605', 'type5'],
        ['980475', 'type5'],
        ['955081', 'type5'],
        ['943369', 'type5'],
        ['727502', 'type5'],
        ['842590', 'type5'],
        ['923336', 'type5'],
        ['140382', 'type5'],
        ['784140', 'type5'],
        ['594874', 'type5'],
        ['558015', 'type5'],
        ['875638', 'type5'],
        ['726602', 'type5'],
        ['903059', 'type5'],
        ['920992', 'type5'],
        ['891204', 'type5'],
        ['899809', 'type5'],
        ['924475', 'type5'],
        ['934410', 'type5'],
        ['859063', 'type5'],
        ['771132', 'type5'],
        ['424767', 'type5'],
        ['932208', 'type5'],
        ['730688', 'type5'],
        ['914536', 'type5'],
        ['927354', 'type5'],
        ['859864', 'type5'],
        ['919172', 'type5'],
        ['906520', 'type5'],
        ['870256', 'type5'],
        ['518054', 'type5'],
        ['538788', 'type5'],
        ['853774', 'type5'],
        ['136133', 'type5'],
        ['895309', 'type5'],
        ['148998', 'type5'],
        ['864303', 'type5'],
        ['856419', 'type5'],
        ['749107', 'type5'],
        ['917356', 'type5'],
        ['914351', 'type5'],
        ['118359', 'type5'],
        ['740167', 'type5'],
        ['490349', 'type5'],
        ['490487', 'type5'],
        ['591391', 'type5'],
        ['203955', 'type5'],
        ['139309', 'type5'],
        ['152532', 'type5'],
        ['164833', 'type5'],
        ['997571', 'type5'],
        ['132148', 'type5'],
        ['1011208', 'type5'],
        ['175317', 'type5'],
    ];
    const TO_APP_ID = 6;

    protected $signature = 'col:import';

    /**
     * The console command description.
     *
     * @var string
     */
    protected $description = '哥大项目导入数据';

    public function handle() {
        $success = 0;
        $total = count(self::DATA_LIST);
        foreach (self::DATA_LIST as $item) {
            $sql = "select * from `user` where id='{$item[0]}'";
            $user = DB::connection("mysql_readonly")->select($sql);
            if ($user[0]) {
                $user = $this->object2array($user[0]);

                MerchantHelper::setMerchantId(self::TO_MERCHANT_ID);
                $oldUid = $user['id'];
                unset($user['id']);
                unset($user['created_at']);
                unset($user['updated_at']);

                $user['merchant_id'] = self::TO_MERCHANT_ID;
                $user['app_id'] = self::TO_APP_ID;
                $newUser = User::model()->updateOrCreateModel($user, ['telephone' => $user['telephone'], 'app_id' => $user['app_id']]);

                foreach (self::TABLES as $tableName => $tableItem) {
                    $where = " user_id='{$oldUid}' {$tableItem['where']}";
                    $sql = "select * from `{$tableName}` where {$where}";
                    $list = DB::connection("mysql_readonly")->select($sql);
                    if ($list) {
                        $model = new $tableItem['model'];
                        foreach ($list as $subItem) {
                            $subItem = $this->object2array($subItem);
                            unset($subItem['id']);
                            unset($subItem['created_at']);
                            unset($subItem['updated_at']);
                            $subItem['user_id'] = $newUser->id;
                            if (isset($subItem['merchant_id'])) {
                                $subItem['merchant_id'] = self::TO_MERCHANT_ID;
                            }
                            if (isset($subItem['dg_pay_lifetime_id'])) {
                                $subItem['dg_pay_lifetime_id'] = '';
                            }

                            $model->updateOrCreateModel($subItem, $subItem);
                        }
                    }
                }
                $coupon = [
                    "merchant_id" => self::TO_MERCHANT_ID,
                    "user_id" => $newUser->id,
                    "coupon_id" => self::COUPON_MAP[$item[1]]
                ];
                ColUserCoupon::model()->updateOrCreateModel($coupon, $coupon);
                $success++;
                echo $user['telephone'] . " OVER " . "{$success}/{$total}" . PHP_EOL;
            }
        }
    }

    private function object2array(&$object) {
        $object = json_decode(json_encode($object), true);
        return $object;
    }

}
